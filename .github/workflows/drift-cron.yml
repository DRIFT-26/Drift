name: DRIFT Scheduled Jobs

on:
  schedule:
    # Every 6 hours
    - cron: "0 */6 * * *"
  workflow_dispatch: {}  # Allows manual run from GitHub UI

jobs:
  run-drift-jobs:
    runs-on: ubuntu-latest

    steps:
      - name: Run Stripe Ingest (last 7 days)
        run: |
          curl -s -X POST "https://drift-app-indol.vercel.app/api/jobs/stripe-ingest?days=7" \
            -H "Authorization: Bearer ${{ secrets.DRIFT_CRON_SECRET }}"

      - name: Run Daily Drift Engine
        run: |
          curl -s -X POST "https://drift-app-indol.vercel.app/api/jobs/daily" \
            -H "Authorization: Bearer ${{ secrets.DRIFT_CRON_SECRET }}"